#########################
# manual testing
#########################

from lib.minasu.db import db
instance = db(instance_name="test_instance",instance_dir="/tmp/tests")
dir(instance)
instance.load()




#-------------------
# chain bucket via instance
#-------------------
    # backslash only needed in the repl
instance.bucket("bucket5") \
        .create()
instance.bucket("") \
        .list()
instance.bucket("bucket5") \
        .destroy()
instance.bucket("") \
        .list()




#-------------------
# separate bucket object
#-------------------
# prep bucket6
bucket6 = instance.bucket("bucket6") 

# create bucket6
bucket6.create() 

# lists ALL buckets
bucket6.list() 

# destroy bucket6
bucket6.destroy()

# still lists all buckets
bucket6.list() 




#-------------------
# items 
#-------------------
# prep bucket7
bucket7 = instance.bucket("bucket7")

# create bucket7
bucket7.create()

# lists ALL buckets
bucket7.list() 

# list all items
bucket7.item("").list()

# read item content
bucket7.item(item_name="item8").read()

# edit item content
bucket7.item(item_name="item8").edit(content={"foo": "bar"})

# read item content again
bucket7.item(item_name="item8").read()

# delete the item
bucket7.item(item_name="item8").delete()

# try to read item content again
bucket7.item(item_name="item8").read()

# destroy bucket7
bucket7.destroy() 

# still lists all buckets
bucket7.list() 




#-------------------
# destroy entire instance
#-------------------
instance.destroy()
